{"version":3,"sources":["request.js"],"names":["Request","sdk","audienceName","_audienceName","_axios","axios","create","_insertHeaders","bind","_sdk","_attachInterceptors","delete","then","data","get","head","options","patch","post","put","request","requestInterceptors","fulfilled","config","interceptors","responseInterceptors","response","forEach","rejected","use","auth","getCurrentApiToken","apiToken","headers","common","Authorization"],"mappings":"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","file":"request.js","sourcesContent":["import axios from 'axios';\n\nclass Request {\n  /**\n   * @param {Object} sdk An instance of the SDK so the module can communicate with other modules\n   * @param {string} audienceName The audience name for this instance. Used when grabbing a\n   *   Bearer token\n   */\n  constructor(sdk, audienceName) {\n    this._audienceName = audienceName;\n    this._axios = axios.create();\n    this._insertHeaders = this._insertHeaders.bind(this);\n    this._sdk = sdk;\n\n    this._attachInterceptors();\n  }\n\n  /**\n   * Makes a DELETE request\n   * See more at {@link https://github.com/axios/axios axios}\n   *\n   * @returns {Promise}\n   * @fulfill {string|number|object|array} data\n   */\n  delete(...args) {\n    return this._axios.delete(...args).then(({ data }) => data);\n  }\n\n  /**\n   * Makes a GET request\n   * See more at {@link https://github.com/axios/axios axios}\n   *\n   * @returns {Promise}\n   * @fulfill {string|number|object|array} data\n   */\n  get(...args) {\n    return this._axios.get(...args).then(({ data }) => data);\n  }\n\n  /**\n   * Makes a HEAD request\n   * See more at {@link https://github.com/axios/axios axios}\n   *\n   * @returns {Promise}\n   * @fulfill {string|number|object|array} data\n   */\n  head(...args) {\n    return this._axios.head(...args).then(({ data }) => data);\n  }\n\n  /**\n   * Makes an OPTIONS request\n   * See more at {@link https://github.com/axios/axios axios}\n   *\n   * @returns {Promise}\n   * @fulfill {string|number|object|array} data\n   */\n  options(...args) {\n    return this._axios.options(...args).then(({ data }) => data);\n  }\n\n  /**\n   * Makes a PATCH request\n   * See more at {@link https://github.com/axios/axios axios}\n   *\n   * @returns {Promise}\n   * @fulfill {string|number|object|array} data\n   */\n  patch(...args) {\n    return this._axios.patch(...args).then(({ data }) => data);\n  }\n\n  /**\n   * Makes a POST request\n   * See more at {@link https://github.com/axios/axios axios}\n   *\n   * @returns {Promise}\n   * @fulfill {string|number|object|array} data\n   */\n  post(...args) {\n    return this._axios.post(...args).then(({ data }) => data);\n  }\n\n  /**\n   * Makes a PUT request\n   * See more at {@link https://github.com/axios/axios axios}\n   *\n   * @returns {Promise}\n   * @fulfill {string|number|object|array} data\n   */\n  put(...args) {\n    return this._axios.put(...args).then(({ data }) => data);\n  }\n\n  /**\n   * Makes a request\n   * See more at {@link https://github.com/axios/axios axios}\n   *\n   * @returns {Promise}\n   * @fulfill {string|number|object|array} data\n   */\n  request(...args) {\n    return this._axios.request(...args).then(({ data }) => data);\n  }\n\n  /**\n   * Sets up axios interceptors for the request instance\n   * More information at {@link https://github.com/axios/axios#interceptors axios Interceptors}\n   *\n   * @private\n   */\n  _attachInterceptors() {\n    const requestInterceptors = [\n      { fulfilled: this._insertHeaders },\n      ...this._sdk.config.interceptors.request\n    ];\n    const responseInterceptors = [...this._sdk.config.interceptors.response];\n\n    requestInterceptors.forEach(({ fulfilled, rejected }) => {\n      this._axios.interceptors.request.use(fulfilled, rejected);\n    });\n    responseInterceptors.forEach(({ fulfilled, rejected }) => {\n      this._axios.interceptors.response.use(fulfilled, rejected);\n    });\n  }\n\n  /**\n   * Decorates custom modules onto the SDK instance so they behave as first-class citizens.\n   *\n   * @param {Object} config\n   * @param {Object} config.headers\n   * @param {Object} config.headers.common\n   *\n   * @returns {Promise}\n   * @fulfill {Object} axios.js config\n   *\n   * @private\n   */\n  _insertHeaders(config) {\n    return this._sdk.auth\n      .getCurrentApiToken(this._audienceName)\n      .then((apiToken) => {\n        config.headers.common.Authorization = `Bearer ${apiToken}`;\n\n        return config;\n      });\n  }\n}\n\nexport default Request;\n"]}